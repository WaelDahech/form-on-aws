<!DOCTYPE html>
<html lang="ar">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>نموذج رفع الفيديو</title>
  </head>
  <body dir="rtl">
    <h1>نموذج رفع الفيديو</h1>
    <form
      action="https://u2v1ztq49i.execute-api.eu-west-3.amazonaws.com/dev/upload/"
      method="post"
      enctype="multipart/form-data"
      id="uploadForm"
    >
      <label for="name">الاسم الأول:</label>
      <input type="text" id="name" name="name" required /><br /><br />

      <label for="surname">اللقب:</label>
      <input type="text" id="surname" name="surname" required /><br /><br />

      <label for="age">العمر:</label>
      <input type="number" id="age" name="age" required /><br /><br />

      <label for="email">البريد الإلكتروني:</label>
      <input type="email" id="email" name="email" required /><br /><br />

      <label for="state">الولاية:</label>
      <input type="text" id="state" name="state" required /><br /><br />
      <label for="audio">رفع الملف الصوتي (MP3):</label>
      <input
        type="file"
        id="audio"
        name="audio"
        accept="audio/*"
        required
      /><br /><br />

      <br /><br />

      <button type="submit">إرسال</button>
    </form>
    <div id="responseMessage" style="display: none; margin-top: 20px">
      <p id="responseText"></p>
    </div>

    <script>
      document
        .getElementById("uploadForm")
        .addEventListener("submit", function (event) {
          event.preventDefault();

          var form = event.target;
          var formData = new FormData(form);
          console.log("form", form);
          console.log("formdata", formData);

          fetch(form.action, {
            method: form.method,
            mode: "no-cors", // Set the request mode to 'no-cors'

            headers: {
              // Set content type to the correct type for binary data
              "Content-Type": "multipart/form-data",
            },
            body: formData,
          })
            .then(function (response) {
              if (response.ok) {
                return response.text();
              } else {
                throw new Error("Network response was not ok.");
              }
            })
            .then(function (data) {
              document.getElementById("responseText").textContent =
                "تم رفع النموذج بنجاح.";
              document.getElementById("responseMessage").style.display =
                "block";
              form.reset();
            })
            .catch(function (error) {
              console.error("Error:", error);
              document.getElementById("responseText").textContent =
                "حدث خطأ أثناء رفع النموذج. الرجاء المحاولة مرة أخرى.";
              document.getElementById("responseMessage").style.display =
                "block";
            });
        });
    </script>
  </body>
</html>
